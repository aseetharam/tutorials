# Differential Gene Expression analysis

For this part, we will use `edgeR` program. You can read more about `edgeR` [here](http://bioconductor.org/packages/release/bioc/html/edgeR.html). `edgeR` supports differential expression analysis of RNA-seq expression profiles (count data) with biological replication. It implements a range of statistical methodology based on the negative binomial distributions, including empirical Bayes estimation, exact tests, generalized linear models and quasi-likelihood tests. This program can also be used for any other counts like genomic data generated from ChIP-seq, Bisulfite-seq, SAGE and CAGE.


## Install `edgeR`

Open the `RStudio` in your laptop and run these commands:

```
## try http:// if https:// URLs are not supported
source("https://bioconductor.org/biocLite.R")
biocLite("edgeR")
```

## Process counts data

Once complete, you are ready to run `edgeR` on your data. To simplify the analysis, we will process the count data such that we have each comparison that we want to run as a separate count file.

The counts data generated by the `featureCounts` has following headers:

```
Geneid  Chr     Start   End     Strand  Length  SRR6826996_starAligned.out.sam .... (11 more file names)
```

we will clean this up, so that we remove `_starAligned.out.sam` from the headers. We will also be not needing `Chr`, `Start`, `End`, `Strand`, and `Length`.

```
cut -f 1,7- counts.txt > counts_clean.txt
sed -i 's/_starAligned.out.sam//g' counts_clean.txt
```

The experiment layout was as follows:

| SRA_ID     | GEO_ID     | Condition    |
|------------|------------|--------------|
| SRR6826996 | GSM3038526 | Control 1    |
| SRR6826997 | GSM3038527 | Control 2    |
| SRR6826998 | GSM3038528 | Control 3    |
| SRR6826999 | GSM3038529 | 4hrs MPLA 1  |
| SRR6827000 | GSM3038530 | 4hrs MPLA 2  |
| SRR6827001 | GSM3038531 | 4hrs MPLA 3  |
| SRR6827002 | GSM3038532 | 24hrs MPLA 1 |
| SRR6827003 | GSM3038533 | 24hrs MPLA 2 |
| SRR6827004 | GSM3038534 | 24hrs MPLA 3 |
| SRR6827005 | GSM3038535 | 3dp MPLA 1   |
| SRR6827006 | GSM3038536 | 3dp MPLA 2   |
| SRR6827007 | GSM3038537 | 3dp MPLA 3   |


So, we will prepare individual files (counts), with
control vs. 4hrs, control vs. 24hrs and control vs. 3dp. If you are interested, you can also do other comparisons such as 4hrs vs. 24hrs, 4hrs vs. 3dp, 24hrs vs. 3dp.
